<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uni Tracker</title>
    <link rel="stylesheet" href="./Css/style.css">
    <script src="https://kit.fontawesome.com/3d59e7110b.js" crossorigin="anonymous"></script>
</head>

<body>
    <div id="overlay"></div>

    <nav class="navbar">
        <div class="nav-brand">
            <img src="icon/Sudan_University_for_Scince_&_Technology.png" alt="Logo" class="nav-logo">
            <span>Uni Tracker</span>
        </div>
        <div class="nav-links">
            <span id="welcome-msg">Hello, Student</span>
            <select id="semester-select" class="semester-dropdown">
                <option value="" disabled >Select Semester</option>
                <option value="1" selected>Semester 1</option>
                <option value="2">Semester 2</option>
                <option value="3">Semester 3</option>
                <option value="4">Semester 4</option>
                <option value="5">Semester 5</option>
                <option value="6">Semester 6</option>
                <option value="7">Semester 7</option>
                <option value="8">Semester 8</option>
            </select>
            <button onclick="window.location.href = 'login.html'" id="login-btn" class="login-btn hidden">Login</button>
            <button onclick="logout()" id="logout-btn" class="logout-btn">Logout</button>
        </div>
    </nav>

    <div class="container">
        <div class="title">
            <h1>University Assignment Tracker</h1>
            <p>Keep track of all your course assignments in one organized place.</p>
        </div>

        <div class="add-popup" id="course-popup">
            <div class="course-head">
                <h2><i class="fa-solid fa-book-open" style="margin-right: 10px;"></i>Add New Course</h2>
                <i class="fa-solid fa-xmark close-btn"></i>
            </div>
            <form id="course-form">
                <label for="course-name">Course Name</label>
                <input name="name" required type="text" id="course-name" placeholder="e.g., Computer Science">

                <label for="semester">Semester</label>
                <input name="semester" min="1" max="8" required type="number" id="semester" placeholder="e.g., 3">

                <div class="btns">
                    <button type="button" class="cancel">Cancel</button>
                    <button type="submit" class="add">Add Course</button>
                </div>
            </form>
        </div>

        <div class="add-popup" id="assignment-popup">
            <div class="assign-head">
                <h2><i class="fa-solid fa-plus" style="margin-right: 10px;"></i>Add New Assignment</h2>
                <i class="fa-solid fa-xmark close-btn"></i>
            </div>
            <form id="assign-form">
                <label for="assign-name">Assignment Title</label>
                <input name="title" required type="text" id="assign-name" placeholder="e.g., Midterm Project">

                <label for="assign-description">Description</label>
                <input name="description" type="text" id="assign-description" placeholder="Optional details">

                <label for="start-date">Start Date</label>
                <input name="start_date" required type="date" id="start-date">

                <label for="end-date">Due Date</label>
                <input name="due_date" required type="date" id="end-date">

                <div class="btns">
                    <button type="button" class="cancel">Cancel</button>
                    <button type="submit" class="assignment-addBtn">Add Assignment</button>
                </div>
            </form>
        </div>

        <div class="cards-box"></div>
        <button class="add-course admin-only">+ Add Course</button>
    </div>

<footer class="footer">
    <div class="footer-container">
        <div class="uni-branding">
            <img src="icon/Sudan_University_for_Scince_&_Technology.png" alt="Sudan Uni Logo">
            <p class="uni-name">Sudan University for Science and Technology</p>
        </div>

        <h4 class="dev-title">Meet the Developers</h4>
        
        <div class="developers-grid">
            <div class="developer-card">
                <h3>Ibrahim Abdelrahman</h3>
                <div class="social-links">
                    <a href="https://github.com/harounMusa" target="_blank"><i class="fa-brands fa-github"></i></a>
                    <a href="#"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="#"><i class="fa-brands fa-linkedin"></i></a>
                </div>
            </div>

            <div class="developer-card">
                <h3>Haroun Musa</h3>
                <div class="social-links">
                    <a href="https://github.com/harounMusa" target="_blank"><i class="fa-brands fa-github"></i></a>
                    <a href="https://x.com/harounnasreldin" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.linkedin.com/in/haroun-musa-1096702b5/" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2025 University Tracker. All rights reserved.</p>
        </div>
    </div>
</footer>
    <script src="./Js/main.js" defer></script>
    <script>
        API_URL = "https://university-assignment-tracker.onrender.com";


    async function checkAdminStatus() {
    try {
        const response = await fetch(`${API_URL}/admin/check`, { credentials: 'include' });
        const data = await response.json();
        
        const isAdmin = !!data.is_admin; // Forces a boolean true/false
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');

        document.body.classList.toggle('admin', isAdmin);

        if (isAdmin) {
            loginBtn.classList.add('hidden');
            logoutBtn.classList.remove('hidden');
            console.log('Logged in as Admin');
        } else {
            loginBtn.classList.remove('hidden');
            logoutBtn.classList.add('hidden');
            console.log('Logged in as Student');
        }

        const welcomeMsg = document.getElementById('welcome-msg');
        if (welcomeMsg) {
            welcomeMsg.textContent = isAdmin ? "Hello, Admin" : "Hello, Student";
        }

    } catch (error) {
        console.error("Auth check failed:", error);
        document.body.classList.remove('admin');
    }
}
        checkAdminStatus();

        function logout() {
            fetch(`${API_URL}/admin/logout`, {
                method: 'POST',
                credentials: 'include'
            }).then(res => {
                if (res.ok)
                    location.reload();
                else
                    alert('Logout failed');
            })
        }
    </script>
</body>

</html>